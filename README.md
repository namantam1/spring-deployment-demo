## Setup tomcat to run the spring app

To bundle your Spring Boot project as a WAR file and deploy it to Tomcat, you need to make a few adjustments to your project configuration and Dockerfile.

Here's how you can do it:

1. Configure Your Spring Boot Application for WAR Packaging:
In your build.gradle file, change the spring-boot-starter-parent dependency to a specific version of Spring Boot. Then, set the packaging to war and include the spring-boot-starter-tomcat dependency, marking it as providedRuntime. This will exclude the embedded Tomcat server from the final WAR package as it will be provided by the servlet container (Tomcat) at runtime.

Here's an example build.gradle configuration:

```gradle
plugins {
    id 'org.springframework.boot' version '2.5.0'
    id 'io.spring.dependency-management' version '1.0.11.RELEASE'
    id 'war'
    id 'java'
}

group = 'com.example'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = '11'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    providedRuntime 'org.springframework.boot:spring-boot-starter-tomcat'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

test {
    useJUnitPlatform()
}
```

2. Create a ServletInitializer:
Create a class that extends SpringBootServletInitializer to configure your Spring Boot application to run in a servlet container. This class should be in your project's src/main/java directory.

```java
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;

public class ServletInitializer extends SpringBootServletInitializer {
    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(YourApplication.class);
    }
}
```
Replace YourApplication with the name of your Spring Boot application class.


3. Update Your Dockerfile:
Update your Dockerfile to use the Tomcat image. Here's an example Dockerfile:

```Dockerfile
FROM openjdk:17-jdk-alpine AS builder

WORKDIR /app
COPY . .
RUN ./gradlew build -x test

FROM tomcat:latest
COPY --from=builder /app/build/libs/your-application.war /usr/local/tomcat/webapps/
```

Replace your-application.war with the name of your WAR file generated by Gradle.

### Advantages of Using Tomcat:

- Versatility: Tomcat is a widely used servlet container with robust support for Java EE specifications.
Production-Grade Server: Tomcat is designed for production use and offers features such as load balancing, clustering, and security.
- Familiarity: Many developers are already familiar with Tomcat, making it easier to deploy and manage applications.
- Separation of Concerns: Separating your application code from the server runtime (Tomcat) allows for easier management and updates of each component independently.
- Using Tomcat allows you to deploy your Spring Boot application to a servlet container, providing more flexibility and scalability compared to running it as a standalone JAR.



## Steps to build and run with docker

```bash
# build the docker image
docker build -t app .

# run the built docker image and expose application to port 8080
docker run -p 8080:8080 app

# For help run for more info about these commmands
docker --help
docker build --help
docker run --help
```

> One can run this project on `play-with-docker` to test.
